ruby:
  items ||= nil
  homepage_section ||= nil
  cols = items.size == 2 ? 6 : 4
  pre_title ||= items.first.item_type.api_key
  title_size = items.size == 2 ? "mid-caption--lead" : "mid-caption--xmlarge"
  icon_classes =
    if items.size == 2
      "icon video_two_col_icon"
    else
      "icon video_three_col_icon"
    end

- if homepage_section
  .pt-5.pb-lg-4
    h2.h6.mid-caption--large.text-center.text-uppercase.font-weight-semibold
      = pre_title

.d-none.d-lg-block
  .row
    - items.map do |item|
      - spacing = homepage_section ? "my-4" : "mb-4"
      div class="col-lg-#{cols}"
        p.mx-lg-4.mid-caption.text-secondary
          = partial "partials/formatted-date",
            locals: {date: item.date_shown}
        h2.mx-lg-4.mb-4.text-primary class=title_size
          = link_to page_path(item),
            class: "text-decoration-none"
            = item.title

.row
  - items.map do |item|

    ruby:
      placeholder = if item.respond_to?(:placeholder_image) &&
        (item.placeholder_image.present? && item.use_placeholder_image)
        true
      end

    div class="col-lg-#{cols}"
      .d-lg-none.my-4.pt-4
        p.ml-lg-4.mid-caption.text-secondary
          = partial "partials/formatted-date",
            locals: {date: item.date_shown}
        h2.ml-lg-4.h4.text-primary.mt-2g
          = link_to page_path(item),
            class: "text-decoration-none"
            = item.title
      = link_to page_path(item)
        .img-responsive-wrapper
          svg.bg-white.icon-primary.rounded.p-1 class=icon_classes
            use xlink:href="/images/sprite.svg#it-video"
          figure.mb-0

            ruby:
              id = item.video.provider_uid
              youtube_thumb = "https://i.ytimg.com/vi/#{id}/maxresdefault.jpg"
              thumbnail = placeholder ? item.placeholder_image : youtube_thumb

            - if placeholder
              = proxy_image_tag thumbnail.lqip_data_url(w: 10,
                h: 10,
                fit: "crop"),
                data: {sizes: "100vw",
                  src: thumbnail.url(w: 700,
                     h: 400,
                     fit: "crop",
                     auto: "compress"),
                  srcset: "#{thumbnail.url(w: 450,
                      h: 330,
                      fit: 'crop',
                      auto: 'compress')} 480w,
                    #{thumbnail.url(w: 600,
                      h: 333,
                      fit: 'crop',
                      auto: 'compress')} 632w,
                      #{thumbnail.url(w: 560,
                        h: 333,
                        fit: 'crop',
                        auto: 'compress')} 844w,
                      #{thumbnail.url(w: 700,
                        h: 400,
                        fit: 'crop',
                        auto: 'compress')} 1091w,
                      #{thumbnail.url(w: 700,
                        h: 400,
                        fit: 'crop',
                        auto: 'compress')} 1320w,
                      #{thumbnail.url(w: 700,
                        h: 400,
                        fit: 'crop',
                        auto: 'compress')} 1440w"},
                class: "video_two_col_thumbnail lazyload d-block",
                alt: thumbnail.alt,
                title: thumbnail.title

            - else
              = image_tag thumbnail,
                class: "video_two_col_thumbnail lazyload d-block"

.row.mt-2.pb-4
  .col-12.text-center.my-5
    = partial "partials/button",
    locals: {btn_url: dato.videos_index,
      label: t("see_more"),
      aria_label: "sezione video"}
